<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>移动端的web相册</title>
    <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
    <link rel="stylesheet" href="http://apps.bdimg.com/libs/animate.css/3.1.0/animate.min.css">
    <style type="text/css">
        body,div,dl,dt,dd,ul,ol,li,h1,h2,h3,h4,h5,h6,pre,
        form,fieldset,input,textarea,p,blockquote,th,td {
            padding: 0;
            margin: 0;
        }
        body{background-color: black;}
        ul{list-style:none;}
        ul li{float:left;width:100px;height:100px;overflow: hidden;}
        ul li img{width:100%;height:100%;}
        .large{width:100%;height:100%;position: absolute;left:0;top:0;background:#000;}
    </style>
    <script src="http://apps.bdimg.com/libs/zepto/1.1.4/zepto.js"></script>
</head>
<body>

    <ul id="container" class="img-container">
        <li><img src="http://s2.nuomi.bdimg.com/upload/deal/2014/1/V_L/623682-1391756281052.jpg" alt=""></li>
        <li><img src="http://img6.ph.126.net/cBR-rjhWWtkRDkCkIa81gQ==/1351361363205139216.jpg" alt=""></li>
        <li><img src="http://i2.w.yun.hjfile.cn/slide/201410/by-Sheribeari_mini1611328688.jpg" alt=""></li>
        <li><img src="http://e.hiphotos.baidu.com/bainuo/crop=0,49,690,418;w=470;q=80/sign=949cc8d4cdef76092844c3df13ed8ff8/95eef01f3a292df57896605cba315c6034a87326.jpg" alt=""></li>
        <li><img src="http://www.51pinwei.com/uploads/allimg/140814/1331-140Q41P1392b.jpg" alt=""></li>
        <li><img src="http://pic60.nipic.com/file/20150211/18733170_145247158001_2.jpg" alt=""></li>
        <li><img src="http://s2.nuomi.bdimg.com/upload/deal/2014/1/V_L/623682-1391756281052.jpg" alt=""></li>
        <li><img src="http://i2.w.yun.hjfile.cn/slide/201410/by-Sheribeari_mini1611328688.jpg" alt=""></li>
        <li><img src="" alt=""></li>
    </ul>
    <div class="large" id="large_container" style="display: none;">
        <img id="large_img" src="img/1.jpg" alt="">
    </div>

<script>

    var total=8;    //8张图片
    var zWin=$(window);
    var render=function(){
        var padding=2;
        var winWidth=zWin.width();
        var picWidth=Math.floor((winWidth - padding * 3)/4);    //单张图片宽度
        var tmpl="";
        for(var i=1;i<=total;i++){
            var p=padding;
            var imgSrc="img/"+i+".jpg";
            //第一张图片没有padding-left:2像素
            if(i%4 == 1){
                p=0;
            }
            tmpl += '<li class="animated bounceIn" data-id="'+i+'" style="width:'+picWidth+'px;height:'+picWidth+'px;padding-left:'+p+'px;padding-top:'+padding+'px;"><img src="'+imgSrc+'" alt="" /></li>';
            /*
            tmpl += '<li class="animated bounceIn" style="width:'+picWidth+'px;height:'+picWidth+'px;padding-left:'+p+'px;padding-top:'+padding+'px;"><canvas id="cvs_'+i+'"></canvas></li>';
            var imageObj=new Image();
            imageObj.index=i;
            imageObj.onload=function(){
                var cvs=$("#cvs_"+this.index)[0];
//                var cvs=document.getElementById("cvs_1");
                cvs.getContext('2d');
                cvs.width=this.width;
                cvs.height=this.height;
                cvs.drawImage(this,0,0);
            };
            imageObj.src=imgSrc;
            */
        }
        $("#container").html(tmpl);
    };
    render();


    var wImage=$("#large_img");
    var loadImg=function(id){
        $("#large_container").show();
        var imgsrc="img/"+id+".jpg";
        var imageObj=new Image();
        imageObj.onload=function(){
            var w=this.width;
            var h=this.height;
            var winWidth=zWin.width();
            var winHeight=zWin.height();
            var realw=winHeight*w/h;
            var paddingLeft=parseInt((winWidth-realw)/2);
            var realh=winWidth*h/w;
            var paddingTop=parseInt((winHeight-realh)/2);
            wImage.css("width","auto").css("height","auto");
            wImage.css("padding-left","0").css("padding-top","0");
            //设置宽高比|可以使用css搞定
            if(h/w>1.2){
                wImage.attr("src",imgsrc).css("height",winHeight).css("padding-left",paddingLeft);
            }else{
                wImage.attr("src",imgsrc).css("width",winWidth).css("padding-left",paddingTop);
            }
            //动画交互
            callback && callback();
        };
        imageObj.src=imgsrc;
    };

    var cid;

    //事件代理
    $("#container").delegate("li","tap",function(){
        var _id = cid = $(this).attr("data-id");
        loadImg(_id);
    });

    //隐藏大图|左右滑动
    $("#large_container").tap(function(){
        $(this).hide();
    }).swipeLeft(function(){
        cid++;
        if(cid > total){
            cid = total;
        }else{
            loadImg(cid,function(){
                wImage.addClass("animated bounceInRight");
            });
        }
    }).swipeRight(function(){
        cid--;
        if(cid < 1){
            cid = 1;
        }else{
            loadImg(cid,function(){
                wImage.addClass("animated bounceInLeft");
            });
        }
    });



</script>

</body>
</html>