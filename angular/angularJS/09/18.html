<!DOCTYPE html>
<html ng-app="MyServiceApp">
<head lang="en">
    <meta charset="UTF-8">
    <title>$Http</title>
    <script src="../js/angular-1.0.1.min.js"></script>
</head>
<body>
    <div ng-controller="ServiceController">
        <label>用户名</label>
        <input type="text" ng-model="username" placeholder="请输入用户名" />
        <pre ng-show="username">{{users}}</pre>
    </div>
</body>
<script>

    var myServiceApp = angular.module("MyServiceApp", []);
    myServiceApp.factory('userListService', ['$http',
        function($http) {
            var doRequest = function(username, path) {
                return $http({
                    method: 'GET',
                    url: 'http://localhost/test/test.php'
                });
            };
            return {
                userList: function(username) {
                    return doRequest(username, 'userList');
                }
            };
        }
    ]);

    myServiceApp.controller('ServiceController', ['$scope', '$timeout', 'userListService',
        function($scope, $timeout, userListService) {
            var timeout;
            $scope.$watch('username', function(newUserName) {
                if (newUserName) {
                    if (timeout) {
                        $timeout.cancel(timeout);
                    }
                    timeout = $timeout(function() {
                        userListService.userList(newUserName)
                                .success(function(data, status) {
                                    $scope.users = data;
                                });
                    }, 350);
                }
            });
        }
    ]);

    //...


</script>
</html>